<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="John C. Uysal">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../../scripts/script.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="../../css/discretopia.css">
    <link rel="icon" href="../../images/k8.svg">
    <link rel="canonical" href="https://discretopia.com/journal/primality-test/">
    <title>Primality test - Discretopia, the friendly discrete math reference</title>
</head>
<body>
    <header>
        <div id="wordmark-container">
            <div id="wordmark" class="centered">
                <a href="../../">DISCRETOPIA</a>
            </div>
        </div>
        <div id="search-container">
            <label for="search-field"></label><input id="search-field" type="text" placeholder="Search Discretopia" name="search">
            <div id="search-results"></div>
        </div>
    </header>
    <main>
        <div id="side-container">
            <div id="logo-container">
                <a href="../../">
                    <svg id="logo" xmlns="http://www.w3.org/2000/svg" class="home-button" width="150" height="150" viewBox="-8 -8 272 272">
                        <line x1="128" y1="0" x2="218.51" y2="37.49" stroke-width="4" />
                        <line x1="128" y1="0" x2="256" y2="128" stroke-width="4" />
                        <line x1="128" y1="0" x2="218.51" y2="218.51" stroke-width="4" />
                        <line x1="128" y1="0" x2="128" y2="256" stroke-width="4" />
                        <line x1="128" y1="0" x2="37.49" y2="218.51" stroke-width="4" />
                        <line x1="128" y1="0" x2="0" y2="128" stroke-width="4" />
                        <line x1="128" y1="0" x2="37.49" y2="37.49" stroke-width="4" />

                        <line x1="218.51" y1="37.49" x2="256" y2="128" stroke-width="4" />
                        <line x1="218.51" y1="37.49" x2="218.51" y2="218.51" stroke-width="4" />
                        <line x1="218.51" y1="37.49" x2="128" y2="256" stroke-width="4" />
                        <line x1="218.51" y1="37.49" x2="37.49" y2="218.51" stroke-width="4" />
                        <line x1="218.51" y1="37.49" x2="0" y2="128" stroke-width="4" />
                        <line x1="218.51" y1="37.49" x2="37.49" y2="37.49" stroke-width="4" />

                        <line x1="256" y1="128" x2="218.51" y2="218.51" stroke-width="4" />
                        <line x1="256" y1="128" x2="128" y2="256" stroke-width="4" />
                        <line x1="256" y1="128" x2="37.49" y2="218.51" stroke-width="4" />
                        <line x1="256" y1="128" x2="0" y2="128" stroke-width="4" />
                        <line x1="256" y1="128" x2="37.49" y2="37.49" stroke-width="4" />

                        <line x1="218.51" y1="218.51" x2="128" y2="256" stroke-width="4" />
                        <line x1="218.51" y1="218.51" x2="37.49" y2="218.51" stroke-width="4" />
                        <line x1="218.51" y1="218.51" x2="0" y2="128" stroke-width="4" />
                        <line x1="218.51" y1="218.51" x2="37.49" y2="37.49" stroke-width="4" />

                        <line x1="128" y1="256" x2="37.49" y2="218.51" stroke-width="4" />
                        <line x1="128" y1="256" x2="0" y2="128" stroke-width="4" />
                        <line x1="128" y1="256" x2="37.49" y2="37.49" stroke-width="4" />

                        <line x1="37.49" y1="218.51" x2="0" y2="128" stroke-width="4" />
                        <line x1="37.49" y1="218.51" x2="37.49" y2="37.49" stroke-width="4" />

                        <line x1="0" y1="128" x2="37.49" y2="37.49" stroke-width="4" />

                        <circle cx="128" cy="0" r="2" stroke-width="0"/>
                        <circle cx="218.51" cy="37.49" r="2" stroke-width="0"/>
                        <circle cx="256" cy="128" r="2" stroke-width="0"/>
                        <circle cx="218.51" cy="218.51" r="2" stroke-width="0"/>
                        <circle cx="128" cy="256" r="2" stroke-width="0"/>
                        <circle cx="37.49" cy="218.51" r="2" stroke-width="0"/>
                        <circle cx="0" cy="128" r="2" stroke-width="0"/>
                        <circle cx="37.49" cy="37.49" r="2" stroke-width="0"/>
                    </svg>
                </a>
            </div>
            <div class="sidebar-block">
                <div class="sidebar-section">
                    <a class="sidebar-link" href="../../">
                        Main page
                    </a>
                    <br>
                    <a class="sidebar-link" href="../">
                        View the journal
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../about">
                        About Discretopia
                    </a>
                    <br>
                    <a class="donation-type sidebar-link" href="https://www.buymeacoffee.com/johncuysal" target="_blank">
                        Donate ♥
                    </a>
                </div>
            </div>
            <div class="sidebar-block">
                <div class="sidebar-section">
                    Overview
                    <hr>
                    <a class="sidebar-link" href="../../journal/#logic-and-proofs">
                        Logic & Proofs
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#set-theory">
                        Set Theory
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#functions">
                        Functions
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#algorithms">
                        Algorithms
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#relations">
                        Relations
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#integer-properties">
                        Integer Properties
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#induction">
                        Induction
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#combinatorics">
                        Combinatorics
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#graphs">
                        Graphs
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#trees">
                        Trees
                    </a>
                    <br>
                    <a class="sidebar-link" href="../../journal/#recursion">
                        Recursion
                    </a>
                </div>
                <div class="sidebar-section">
                    Guides
                    <hr>
                    <a class="sidebar-link" href="../../guides/how-to-write-a-proof">
                        <!--How to write a proof-->
                    </a>
                </div>
                <div class="sidebar-section">
                    Downloads
                    <hr>
                    <a class="sidebar-link" href="../../pdfs/symbol-cheat-sheet.pdf">
                        <!--What's that symbol?-->
                    </a>
                </div>
            </div>
        </div>
        <div id="content-container">
            <div id="content">
                <div id="title-box">
                    <h1>Primality test</h1>
                    <hr>
                    <i>Last Updated: 5 June 2023</i>
                </div>
                <div id="written-content">
                    <p>
                        A <b>primality test</b> is an <a href="../algorithm">algorithm</a> that determines whether an <a href="../integer">integer</a> is prime.
                    </p>
                    <p>
                        Unlike <a href="../factoring-algorithm">factoring algorithms</a>, efficient primality tests actually do exist, but there is a slight catch.
                    </p>
                    <div id="list-of-contents">
                        <div class="centered">
                            <b>Contents</b>
                        </div>
                        <hr>
                    </div>
                    <h2>Trial division</h2>
                    <hr>
                    <p>
                        Trial division is the most basic <a href="../brute-force-algorithm">brute-force</a> implementation of a primality test:
                    </p>
                    <pre class="code-block"><b>algorithm</b> is_prime <b>is</b><br>    <b>input:</b> one integer, n > 1<br>    <b>output:</b> true if n is prime, false if n is composite<br><br>    <b>for</b> f = 2 <b>to</b> (n - 1)<br>        <b>if</b> n <b>mod</b> f = 0<br>            <b>return</b> false<br>    <b>return</b> true<br></pre>
                    <p>
                        This algorithm can be made more efficient if we understand that, for any two integers whose product is the integer \(n\), one of the integers must be greater than or equal to \(\sqrt{n}\), while the other must be less than or equal to \(\sqrt{n}\). If this is not the case, their imbalanced product will end up being either larger or smaller than \(n\). Here's the improved algorithm:
                    </p>
                    <pre class="code-block"><b>algorithm</b> is_prime <b>is</b><br>    <b>input:</b> one integer, n > 1<br>    <b>output:</b> true if n is prime, false if n is composite<br><br>    <b>for</b> f = 2 <b>to</b> floor(√n) <span class="code-comment">(floor function ensures √n is an integer)</span><br>        <b>if</b> n <b>mod</b> f = 0<br>            <b>return</b> false<br>    <b>return</b> true<br></pre>
                    <p>
                        With the \(6k \pm 1\) optimization, the algorithm can be further improved to skip any factors that are multiples of \(2\) or \(3\), making it faster to check larger integers for primality:
                    </p>
                    <pre class="code-block"><b>algorithm</b> is_prime <b>is</b><br>    <b>input:</b> one integer, n > 1<br>    <b>output:</b> true if n is prime, false if n is composite<br><br>    <b>if</b> n ≤ 3<br>        <b>return</b> true<br>    <b>if</b> n <b>mod</b> 2 = 0 <b>or</b> n <b>mod</b> 3 = 0<br>        <b>return</b> false<br>    f ← 5<br>    <b>while</b> f ≤ floor(√n) <span class="code-comment">(floor function ensures √n is an integer)</span><br>        <b>if</b> n <b>mod</b> f = 0 <b>or</b> n <b>mod</b> (f + 2) = 0<br>            <b>return</b> false<br>        f ← f + 6<br>    <b>return</b> true<br></pre>
                    <p>
                        Even though we've improved trial division a lot, it could still be much better. Notice that, if we wanted to, we could report the factor that divided \(n\) instead of returning false. Trial division always provides information about which factor divided \(n\). However, in primality testing, all we want to know is whether an integer is prime or composite, not what the specific factors are.
                    </p>
                    <p>
                        You might think this is really weird, but it's actually possible to quickly determine that an integer is composite without having <i>any idea what its factors are</i>, as is the case in probabilistic tests.
                    </p>
                    <h2>Probabilistic tests</h2>
                    <hr>
                    <p>
                        In exchange for absolute certainty, probabilistic primality tests significantly reduce computational complexity. This means that, rather than guaranteeing an integer is prime, these kinds of tests can guess with a high degree of correctness that an integer is "probably prime." The probability of error can be minimized with more iterations, making this method ideal for large integers.
                    </p>
                    <p>
                        Due to having polynomial <a href="../time-complexity">time complexity</a>, probabilistic tests are considered efficient.
                    </p>
                    <p>
                        I'd show you an example of a probabilistic test, but for now, I'm just going to say they involve testing integers for properties that only primes can have, and making guesses based on that. If you're curious, check out the Miller-Rabin primality test. An example of a probabilistic test may appear here someday...
                    </p>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <div id="footer-content-container">
            © 2023 <a class="footer-link" href="https://johncuysal.com" target="_blank">John C. Uysal</a>
        </div>
    </footer>
</body>
</html>